function buildAbsoluteKeypath(parentPath, keypath){
	var key = removeAlias(keypath);

	if(parentPath){
		return key ? parentPath + '.' + removeAlias(keypath) : parentPath;
	}else{
		return keypath;
	}
}

function collectParentsKeypath(model, keypathes){
	keypathes = keypathes || [];
	if(model && model.keypath){
		keypathes.unshift(keypathModifier(model), model.index);
		collectParentsKeypath(model.__proto__, keypathes);
	}

	return keypathes;
}

function keypathModifier(model){
	if(model.__proto__.keypath){
		return removeAlias(model.keypath);
	}

	return model.keypath;
}

function removeAlias(keypath){
	return keypath.split('.').slice(1).join('.');
}

 module.exports = function(parentScope, keypath){
	return buildAbsoluteKeypath(collectParentsKeypath(parentScope).join('.'), keypath);
}