const gulp = require('gulp');
const del = require('del');
const plumber = require('gulp-plumber');
const watch = require('gulp-watch');
const babel = require('gulp-babel');

gulp.task('build', ['build-js']);

gulp.task('watch', ['clean-js'], () => {
  const watcher = function (name, parameters, tasks) {
    watch(parameters, { name, ignoreInitial: true, verbose: true }, () => {
      gulp.start(tasks);
    });
  };

  watcher('Watch-js', ['./src/**/*.js'], ['build-js']);
});

gulp.task('build-js', ['clean-js'], () => gulp.src('src/js/**')
.pipe(plumber())
.pipe(babel({ presets: [require('babel-preset-es2015')] }))
.pipe(plumber.stop())
.pipe(gulp.dest('dist/js/')));

gulp.task('clean-js', () => del('dist/js/*.*', { force: true }));

