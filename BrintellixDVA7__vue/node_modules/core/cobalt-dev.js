var Cobalt = require('./src/js/cobalt-api')
var utils = require('utils')
var settings = require('settings')

var IS_IE11 = !!navigator.userAgent.match(/Trident\/7\./)

require('./src/js/event-locker.js')

linkCoreStyles()
linkThemesStyle()

if(IS_IE11){ // fonts bug via @import
  resetStyleSheets()
}

module.exports = Cobalt

function linkThemesStyle () {
  var theme = settings.theme;
  if(theme){
    linkStyles(theme.path + '/theme.css')
  }
}

function linkCoreStyles () {
  linkStyles(settings.components + 'core/css/base.css')
}

function linkStyles (href) {
  var link = document.createElement('link')

  link.rel = 'stylesheet'
  link.href = href
  utils.prependChild(document.head, link)
}

function resetStyleSheets(){
  utils.toArray(document.styleSheets)
    .forEach(function(sheet){
      sheet.disabled = true
      sheet.disabled = false
  })  
}