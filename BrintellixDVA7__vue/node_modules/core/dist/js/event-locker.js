'use strict';

Object.defineProperty(exports, "__esModule", {
	value: true
});
exports.unlockEvents = exports.lockEvents = undefined;

var _dispatcher = require('dispatcher');

var _dispatcher2 = _interopRequireDefault(_dispatcher);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

//get all events - \m/
var ALL_DOCUMENT_EVENTS = findAllDocumentEvents();

function findAllDocumentEvents() {
	return Object.getOwnPropertyNames(document).concat(Object.getOwnPropertyNames(Object.getPrototypeOf(Object.getPrototypeOf(document)))).filter(function (property) {
		return !property.indexOf('on') && (document[property] == null || typeof document[property] == 'function');
	}).map(normalizeEventName);
}

function normalizeEventName(event) {
	return event.replace(event.substr(0, 2), '');
}

function eventBlocker(event) {
	event.stopPropagation();
}

function lockEvents() {
	ALL_DOCUMENT_EVENTS.forEach(function (event) {
		window.addEventListener(event, eventBlocker, true);
	});
}

function unlockEvents() {
	ALL_DOCUMENT_EVENTS.forEach(function (event) {
		window.removeEventListener(event, eventBlocker, true);
	});
}

_dispatcher2.default.subscribeAction(function (action) {
	switch (action.type) {
		case _dispatcher2.default.ActionType.EDIT_PRESENTATION:
			lockEvents();
			break;
		case _dispatcher2.default.ActionType.VIEW_PRESENTATION:
			unlockEvents();
			break;
	}
});

exports.lockEvents = lockEvents;
exports.unlockEvents = unlockEvents;