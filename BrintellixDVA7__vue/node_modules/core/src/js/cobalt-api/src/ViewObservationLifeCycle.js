import componetsDOMObserver from './componetsDOMObserver.js';

export default class ViewObservationLifeCycle {
	constructor(dispatcher){
		this.subscriber = null;

		dispatcher.subscribeAction(action => {
			switch(action.type) {
				case dispatcher.ActionType.EDIT_PRESENTATION :
					if(this.subscriber){
						this.reset();
					}
					this.init(dispatcher);
					break;
				case dispatcher.ActionType.VIEW_PRESENTATION :
					this.reset();
					break;
			}
		});
	}

	init(dispatcher){
		this.subscriber = componetsDOMObserver.subscribe(component => {
			dispatcher.dispatchEvent({
				type: dispatcher.EventType.DOM_REFRESHED,
				element: component
			})
		})
	}

	reset(){
		this.subscriber.unsubscribe();
		this.subscriber = null;
	}
}